\documentclass{bmstu}

\usepackage{pdfpages}

\addbibresource{inc/biblio/sources.bib}

\begin{document}

\includepdf[pages=-]{inc/img/title.pdf}

\setcounter{page}{3}

{\centering \chapter*{РЕФЕРАТ}}

Отчет 26 с., 10 рис., 1 табл., 8 источн., 1 прил.

\noindent ВИДЕО, ВИДЕОПОТОК, ВИДЕОИЗОБРАЖЕНИЕ, РАЗРЕШЕНИЕ, НЕЙРОННЫЕ СЕТИ

Объектом исследования являются методы увеличения разрешения видеопотока.

Цель работы: классификация известных методов увеличения разрешения видеопотока.

В результате исследования было проведено сравнение 4-х методов увеличения разрешения видеопотока по 4-м критериям.

Область применения результатов --- выбор метода для увеличения разрешения видеопотока.

Результат работы. 
Нельзя точно сказать, какой из рассмотренных методов увеличения разрешения видеопотока является наилучшим. 
Самый высокий показатель пикового отношения сигнала к шуму у метода нелокальной регуляризации и надежной оценки движения, в то время как у метода динамических фильтров увеличения разрешения без явной компенсации движения наилучший показатель индекса структурного сходства. 
Притом второй метод позволяет увеличивать разрешение видеопотока в 4 раза. 
Наихудшим из рассмотренных по всем показателям оказался метод бикубической интерполяции.

\maketableofcontents

{\centering \chapter*{ПЕРЕЧЕНЬ СОКРАЩЕНИЙ И ОБОЗНАЧЕНИЙ}}

В настоящей расчетно-пояснительной записке к научно-исследовательской работе применяют следующие сокращения и обозначения:

\begin{table}[H]
\begin{tabular}{p{3cm}p{13.5cm}}
VSR & Суперразрешение видео (video super-resolution)
\tabularnewline
RGB & Красный, зеленый, синий (red, green, blue)
\tabularnewline
SISR & Суперразрешение фото (single-image super-resolution)
\tabularnewline
DFT & Дискретное преобразование Фурье (discrete Fourier transform)
\tabularnewline
DCT & Дискретное косинусное преобразование (discrete cosine transform)
\tabularnewline
DWT & Дискретное вейвлет-преобразование (discrete wavelet transform)
\tabularnewline
POCS & Проецирование в выпуклые множества (projections onto convex sets)
\tabularnewline
RLS & Рекуррентный метод наименьших квадратов (recursive least squares)
\tabularnewline
MAP & Оценка апостериорного максимума (maximum a posteriori probability)
\tabularnewline
MLE & Метод максимального правдоподобия (maximum likelihood estimation)
\tabularnewline
MRF & Марковское случайное поле (Markov random field)
\tabularnewline
SSIM & Индекс структурного сходства (structure similarity)
\tabularnewline
PSNR & Пиковое отношение сигнала к шуму (peak signal-to-noise ratio)
\tabularnewline
\end{tabular}
\end{table}

{\centering \chapter*{ВВЕДЕНИЕ}}
\addcontentsline{toc}{chapter}{ВВЕДЕНИЕ}

Суперразрешение --- это способ получения видеопотока (изображения) с высоким разрешением из видеопотока (изображения) низкого разрешения~\cite{Park2003}. 
В отличие от суперразрешения одного изображения (SISR), основная цель суперразрешения видео --- не только восстановить больше мелких деталей при сохранении крупных, но и сохранить согласованность движения.

Во многих областях, работающих с видео, люди имеют дело с различными типами деградации видео, включая понижение разрешения. 
Разрешение видео может снизиться из-за несовершенства устройств фото- и видеосъемки. 
Плохое освещение и погодные условия добавляют шум. 
Движение объектов и камеры также ухудшает качество видео. 
Методы суперразрешения помогают восстановить исходное видео. 
Это полезно в широком спектре приложений, таких как~\cite{Daithankar2021}:
\begin{enumerate}
\item[1)] видеонаблюдение (для улучшения качества видео, снятого с камеры, а также распознавания номеров автомобилей и лиц);
\item[2)] медицинская визуализация (чтобы лучше обнаружить некоторые органы или ткани для клинического анализа и медицинского вмешательства);
\item[3)] судебно-медицинская экспертиза (для помощи в расследовании в ходе уголовного процесса);
\item[4)] астрономия (для улучшения качества видео звезд и планет);
\item[5)] дистанционное зондирование (для облегчения наблюдения за объектом);
\item[6)] микроскопия (для усиления возможностей микроскопов).
\end{enumerate}

Суперразрешение видео также помогает решить задачу обнаружения объектов, распознавания лиц и символов (в качестве этапа предварительной обработки).

Суперразрешение видео является давней сложной задачей, главным образом по следующим двум причинам: эта задача по своей сути является некорректно поставленной из-за характера отображения <<один ко многим>> (один кадр низкого разрешения может отображаться в различные кадры высокого разрешения) и на сегодняшний день не существует удовлетворительной архитектуры, предназначенной для интеграции пространственной и временной информации в единую структуру~\cite{Xiaobin2019}.

Цель научно-исследовательской работы: провести обзор известных методов увеличения разрешения видеопотока и классифицировать их по сформулированным критериям.

Задачи научно-исследовательской работы:
\begin{enumerate}
\item[1)] исследовать предметную область увеличения разрешения видеопотока;
\item[2)] проанализировать известные методы увеличения разрешения видеопотока;
\item[3)] сформулировать критерии для сравнения этих методов;
\item[4)] сравнить методы увеличения разрешения видеопотока по сформулированным критериям.
\end{enumerate}

\chapter{Анализ предметной области}

\section{Суперразрешение видео}

Суперразрешение --- это набор действий, выполняемых с целью получения изображения (или последовательности изображений) высокого разрешения из последовательности изображений низкого разрешения. 
Концепция суперразрешения представлена на рисунке~\ref{img:sr-concept}. 
Суперразрешение позволяет получить изображение или видео повышенного качества с большим количеством деталей на сцене, что важно для точного анализа~\cite{Daithankar2021}. 

\includeimage
    {sr-concept}
    {f}
    {H}
    {1\textwidth}
    {Концепция суперразрешения~\cite{Daithankar2021}}

Суперразрешение может быть оптическим и геометрическим. 
В оптических методах используются характеристики оптики, датчиков и компонентов дисплея устройства визуализации, которые отвечают за ухудшение качества или понижение разрешения изображения. 
Улучшение пространственного разрешения устройства визуализации может быть достигнуто путем модификации аппаратного обеспечения двумя способами~\cite{Daithankar2021}: увеличить количество пикселей (но есть ограничения, т.~к. это уменьшает отношение сигнал/шум и увеличивает время получения изображения) и увеличить размер чипа, необходимого для получения изображений высокого разрешения (такие чипы достаточно дорогие)~\cite{Park2003}.

Хорошей альтернативой обоим подходам является использование метода автономного улучшения разрешения, то есть геометрического суперразрешения. 
В этом типе суперразрешения для восстановления и реконструкции изображения используются методы цифровой обработки изображений~\cite{Daithankar2021}.

Благодаря широкой применимости концепции суперразрешения это одно из наиболее быстро развивающихся направлений в области обработки изображений~\cite{Yue2016}.

\section{Понижение разрешения}

На рисунке~\ref{img:frame-degradation} показан процесс понижения разрешения изображения.

\includeimage
    {frame-degradation}
    {f}
    {H}
    {1\textwidth}
    {Процесс понижения разрешения изображения~\cite{Daithankar2021}}
    
Приведенный процесс можно записать с помощью формулы:
\begin{equation} 
\label{eq:frame-degradation}
Y = D * H * F * X + V,
\end{equation}
где $Y$ --- изображение с низким разрешением, $H$ --- коэффициент размытия (которое появляется из-за особенностей камеры), $D$ --- коэффициент децимации, $F$ --- деформация, а $V$ --- коэффициент шума~\cite{Daithankar2021}.

В приведенной выше формуле факторами деградации являются $F$, $H$, $D$ и $V$. 
Если эти коэффициенты известны разработчику, то система называется системой с предварительно известными данными, а изображение с высоким разрешением получается путем решения математического уравнения~\ref{eq:frame-degradation}~\cite{Daithankar2021}.

\section{Подходы к увеличению разрешения видеопотока}

Самый простой способ реализовать суперразрешение видео --- покадровый запуск алгоритмов суперразрешения фото. 
Однако, поскольку методы суперразрешения фото не учитывают временные отношения между кадрами, существует высокая вероятность того, что последовательные кадры не будут соединены естественным образом, что приведет к мерцающим артефактам~\cite{Younghyun2018}.

Суперразрешение осуществляется или покадрово, или используя сразу несколько кадров. 
Субпиксельный сдвиг между последовательными кадрами используется для восстановления кадров высокого разрешения в многокадровых методах суперразрешения. 
Однокадровые методы стремятся улучшить качество изображения без добавления размытия. 
Алгоритмы суперразрешения работают в двух областях --- частотной и пространственной. 
На рисунке~\ref{img:sr-methods} представлены некоторые методы суперразрешения видео~\cite{Daithankar2021}.

\includeimage
    {sr-methods}
    {f}
    {H}
    {0.75\textwidth}
    {Некоторые методы суперразрешения видеопотока~\cite{Daithankar2021}}

\chapter{Методы увеличения разрешения видеопотока}

\section{Бикубическая интерполяция}

В пространственной области процесс восстановления происходит путем обработки на уровне пикселей вместо работы с каким-либо признаком изображения. 
Алгоритмы, работающие в пространственной области, в основном делятся на интерполяционные и регуляризационные~\cite{Daithankar2021}.

Самый простой способ повысить разрешение изображения --- интерполяция. 
Процесс интерполяции --- это оценка нового пикселя с помощью заданного набора пикселей. 
Регистрация, интерполяция и восстановление --- три основных этапа интерполяционных методов суперразрешения~\cite{Thapa2016}. 
Геометрическое выравнивание происходит при регистрации изображений, при которой изображения низкого разрешения выравниваются по одному конкретному изображению низкого разрешения, используемому в качестве эталона. 
Смещения и повороты субпикселей необходимы для точной оценки параметров движения перед их объединением для создания изображения высокого разрешения~\cite{Daithankar2021}.

Бикубическая интерполяция является более трудоемким методом, чем интерполяция методом <<ближайшего соседа>> и билинейная интерполяция. 
В отличие от билинейной интерполяции, коэффициенты бикубической интерполяции в 16-и ближайших пикселях обеспечивают более гладкую поверхность, поскольку связь с известными пикселями имеет полиномиальный, а не линейный характер. 
Полином третьей степени с коэффициентами $a_0,~...,~a_3$ записывается как $f(x) = \sum_{i = 0}^{3} a^ix^i$. 
Предположим, есть четыре известные точки $f(p_1),~f(p_2),~f(p_3),~f(p_4)$, которые окружают неизвестную точку $f(p)$, где $f$ --- некий полином третьей степени. 
Запишем функцию $f$ и известные точки $p_1,~...,~p_4$ в матричном представлении~\cite{Bavenstrand2021}:
\begin{equation}
y = \begin{bmatrix}
f(p_1) & f(p_2) & f(p_3) & f(p_4)
\end{bmatrix}^{T},
\end{equation}
\begin{equation}
B = \begin{bmatrix}
    (p_1)^3 & (p_1)^2 & (p_1)^1 & (p_1)^0 \\
    (p_2)^3 & (p_2)^2 & (p_2)^1 & (p_2)^0 \\
    (p_3)^3 & (p_3)^2 & (p_3)^1 & (p_3)^0 \\
    (p_4)^3 & (p_4)^2 & (p_4)^1 & (p_4)^0
\end{bmatrix},
\end{equation}
\begin{equation}
a = \begin{bmatrix}
a_3 & a_2 & a_1 & a_0
\end{bmatrix}^{T},
\end{equation}
\begin{equation}
y = Ba.
\end{equation}

Чтобы посчитать $f(p)$, степени $p_1,~\dots,~p_4$ умножаются на коэффициенты $a_0,~\dots,~a_3$. 
Так как константы $a_0,~\dots,~a_3$ неизвестны, они выражаются из предыдущих уравнений, что приводит к уравнениям~\cite{Bavenstrand2021}:
\begin{equation}
b = \begin{bmatrix}
p^3 & p^2 & p^1 & p^0
\end{bmatrix},
\end{equation}
\begin{equation}
f(p) = ba = bB^{-1}y.
\end{equation}

Бикубическая интерполяция --- это кубическая интерполяция по двум измерениям для поиска поверхности, а не прямой. 
На рисунке~\ref{img:artifacts} показаны распространенные артефакты, возникающие при использовании методов интерполяции: алиасинг (эффект <<ступенчатости>> изображения), сглаживание и эффект гало~\cite{Bavenstrand2021}.

\includeimage
    {artifacts}
    {f}
    {H}
    {1\textwidth}
    {Распространенные артефакты, возникающие при использовании методов интерполяции~\cite{Bavenstrand2021}}

\section{Метод, основанный на нелокальной регуляризации и надежной оценке движения}

Данный метод состоит из двух шагов: регистрация, где оценивается движение между изображениями низкого разрешения, и восстановление изображения, при котором изображение высокого разрешения восстанавливается из изображений низкого разрешения с использованием информации о движении и размытии~\cite{Jian2014}.

Основан метод на многостороннем фильтре, который используется для регуляризации процесса оценки движения. 
Этот фильтр может адаптивно корректировать оценку движения в соответствии с надежностью оценки, неоднородностью интенсивности изображения и несходством движения~\cite{Jian2014}.

На рисунке~\ref{img:nlrrme-vsr} изображена диаграмма суперразрешения видео. 
Исходная видеопоследовательность высокого разрешения создается путем деформации опорного кадра (красный прямоугольник) несколькими полями движения. 
Затем последовательность кадров высокого разрешения сглаживается с помощью ядра размытия, субдискретизируется и загрязняется шумом для создания наблюдаемой последовательности кадров низкого разрешения. 
Предлагаемый метод суперразрешения видео не только оценивает последовательность кадров высокого разрешения, но также движение, ядро размытия и веса соответствия~\cite{Jian2014}.

\includeimage
    {nlrrme-vsr}
    {f}
    {H}
    {1\textwidth}
    {Диаграмма суперразрешения видео~\cite{Jian2014}}

Пусть $z$ --- <<размытое>> изображение высокого разрешения, $F_t$ --- поле движения и $W_t$ --- матрица весов. 
Для решения задачи регистрации используется метод оценки апостериорного максимума~\cite{Jian2014}:
\begin{equation}
\{z^{*},~\{F_t\}^{*},~\{W_t\}^{*}\} = arg~max~p(z,~\{F_t\},~\{W_t\}|\{y_t\}).
\end{equation}
В этой формуле апостериорная вероятность --- произведение априорной вероятности на функцию правдоподобия~\cite{Jian2014}:
\begin{equation}
p(z,~\{F_t\},~\{W_t\}|\{y_t\}) = p(\{y_t\}|z,~\{F_t\},~\{W_t\}) \cdot p(z) \cdot p(\{F_t\},~\{W_t\}).
\end{equation}
В данной формуле $p(\{y_t\}|z,~\{F_t\},~\{W_t\})$ --- функция правдоподобия, а $p(z)$ и $p(\{F_t\},~\{W_t\})$ --- априорные значения скрытого изображения и полей движения соответственно~\cite{Jian2014}.

Условное распределение кадра $y_t$ низкого разрешения:
\begin{equation}
p(y_t|z,~F_t,~W_t) = \exp(-\frac{||DF_{t}z - y_t||_{W_t}^{2}}{2 \sigma^2}),
\end{equation}
где запись $||a||_{W}^2 = a^{T}Wa$ представляет взвешенную сумму квадратов. 
Предполагая статистическую независимость гауссовского шума среди полученных изображений низкого разрешения, условное распределение набора этих изображений $y_t$ может быть записано как~\cite{Jian2014}:
\begin{equation}
p(\{y_t\}|z,~\{F_t\},~\{W_t\}) = \prod_{t = 1}^{T} p(y_t|z,~F_t,~W_t) = \exp(-\frac{||DF_{t}z - y_t||_{W_t}^{2}}{2 \sigma^2}).
\end{equation}

С помощью приведенной оценки апостериорного максимума изображение высокого разрешения и оценка движения могут постепенно уточняться альтернативным и итеративным способами~\cite{Jian2014}.

\section{Методы, основанные на использовании нейронных сетей}

Традиционные методы суперразрешения видео используют несколько кадров низкого разрешения в качестве входных данных и на выходе выдают кадры высокого разрешения, принимая во внимание субпиксельные движения между соседними кадрами низкого разрешения. 
Все методы суперразрешения видео, основанные на глубоком обучении, работают именно по этому принципу и состоят из двух этапов: оценки движения и процедуры компенсации, за которой следует процесс увеличения разрешения. 
Одна из проблем этого двухэтапного подхода заключается в том, что результаты во многом зависят от точной оценки движения. 
Другая потенциальная проблема заключается в том, что выходной кадр высокого разрешения создается путем смешивания значений из нескольких входных кадров низкого разрешения с компенсацией движения через сверточные нейронные сети, что может привести к размытому выходному кадру высокого разрешения~\cite{Younghyun2018}.

\subsection{Динамические фильтры увеличения разрешения без явной компенсации движения}

В этом методе вместо явного вычисления и компенсации движения между входными кадрами, информация о движении неявно используется для генерации динамических фильтров увеличения разрешения. 
С помощью сгенерированных фильтров кадр высокого разрешения напрямую строится путем локальной фильтрации входного центрального кадра. 
Поскольку этот метод не полагается на явное вычисление движения и не объединяет напрямую значения из нескольких кадров, можно создавать гораздо более четкие и согласованные по времени видео высокого разрешения~\cite{Younghyun2018}.

На рисунке~\ref{img:duf-example} показан пример масштабирования пикселя $(3,~3)$ центрального входного кадра $X_t$ с помощью коэффициента масштабирования $r = 4$. 
Шестнадцать сгенерированных фильтров от $F^{3,3,0,0}_t$ до $F^{3,3,3,3}_t$ используются для создания шестнадцати пикселей в области от $(12,~12)$ до $(15,~15)$ кадра $\hat{Y}_t$ высокого разрешения~\cite{Younghyun2018}.

\includeimage
    {duf-example}
    {f}
    {H}
    {0.75\textwidth}
    {Пример масштабирования пикселя~\cite{Younghyun2018}}
    
Цель суперразрешения видео --- оценить кадры $\{\hat{Y}_t\}$ высокого разрешения по последовательности кадров $\{X_t\}$ низкого разрешения. 
Кадры $\{X_t\}$ низкого разрешения --- это субдискретизированные исходные кадры $\{Y_t\}$, где $t$ --- шаг по времени. 
С предложенной нейронной сетью $G$ и параметрами сети $\theta$ задача суперразрешения видео определяется как:
\begin{equation}
\hat{Y}_t = G_\theta(X_{t - N:t + N}),
\end{equation}
где $N$ --- временной радиус. 
Форма входного массива данных для $G$ --- $T \times H \times W \times C$, где $T = 2N + 1$, $H$ и $W$ --- высота и ширина входного кадра низкого разрешения, а $C$ --- количество цветовых каналов. 
Соответствующая форма выходного массива данных --- $1 \times rH \times rW \times C$, где $r$ --- коэффициент масштабирования~\cite{Younghyun2018}.

Нейронная сеть $G$ на выходе дает два значения для генерации конечного кадра высокого разрешения $\hat{Y}_t$ из множества кадров низкого разрешения $\{X_{t - N:t + N}\}$: динамические фильтры $F_t$ увеличения разрешения и остаток $R_t$. 
Входной центральный кадр $X_t$ сначала локально фильтруется с помощью динамических фильтров $F_t$ увеличения разрешения, а затем остаток $R_t$ добавляется к результату для окончательного вывода $\hat{Y}_t$.

На рисунке~\ref{img:duf-nn} показана архитектура нейронной сети. 

\includeimage
    {duf-nn}
    {f}
    {H}
    {1\textwidth}
    {Архитектура нейронной сети~\cite{Younghyun2018}}
    
Динамические фильтры увеличения разрешения. 
Сначала множество входных кадров $\{X_{t - N:t + N}\}$ низкого разрешения попадают на вход сети генерации динамических фильтров. 
Обученная сеть выдает множество $r^{2}HW$ фильтров $F_t$ увеличения разрешения определенного размера, которые затем используются для генерации новых пикселей отфильтрованного кадра $\hat{Y}_t$. 
Далее создаются выходные пиксели высокого разрешения с помощью локальной фильтрации входного кадра $X_t$ с помощью соответствующего фильтра:
\begin{equation}
\hat{Y_t}(yr + v,~xr + u) = \sum_{j = -2}^{2} \sum_{i = -2}^{2} F^{y,x,v,u}_{t}(j + 2,~i + 2)X_{t}(y + j,~x + i),
\end{equation}
где $y$ и $x$ --- координаты пикселя кадра низкого разрешения, $v$ и $u$ --- координаты каждого выходного блока $r \times r$ ($0 \leq v,~u \leq r - 1$). 
Эта операция аналогична обратной свертке, поэтому данную сеть можно обучать сквозным образом, поскольку она допускает обратное распространение ошибки~\cite{Younghyun2018}.

Добавление остатка. 
Результату после применения динамических фильтров увеличения разрешения не хватает резкости, поскольку он представляет собой взвешенную сумму входных пикселей. 
Могут быть детали, которые невозможно восстановить с помощью линейной фильтрации. 
Чтобы решить эту проблему, дополнительно оценивается остаточное изображение, чтобы увеличить детализацию~\cite{Younghyun2018}.

\subsection{Остаточная обратимая пространственно-временная нейронная сеть}

В данном методе используется сеть, которая состоит из трех компонентов: пространственная составляющая, временная составляющая и составляющая восстановления (реконструкции). 
В пространственном компоненте остаточный обратимый блок предназначен для извлечения информативных признаков с помощью пространственной информации. 
Во временном компоненте используется остаточная плотная сверточная длинная кратковременная память (RDC-LSTM) для изучения последовательного представления признаков. 
Компонент реконструкции используется для интеграции пространственных и временных характеристик в единую структуру. 
На рисунке~\ref{img:ristn-nn} показана структура остаточной обратимой пространственно-временной сети~\cite{Xiaobin2019}.

\includeimage
    {ristn-nn}
    {f}
    {H}
    {1\textwidth}
    {Структура остаточной обратимой пространственно-временной сети~\cite{Xiaobin2019}}
    
В пространственном компоненте последовательные кадры низкого разрешения подаются на слой дополнения, который создает исходные карты признаков путем дополнения нулями в каналах RGB. 
Два последующих параллельных остаточных обратимых блока имеют разную архитектуру с разным количеством слоев для использования иерархических признаков. 
Выходные карты признаков предыдущего остаточного обратимого блока будут объединены и затем помещены в следующие параллельные остаточные обратимые блоки. 
Примечательно, что объединение может эффективно увеличить разнообразие карт признаков. 
Во временном компоненте предлагается использовать остаточную плотную сверточную сеть с длинной краткосрочной памятью для обработки признаков непрерывных кадров. 
В компоненте реконструкции используется метод объединения разреженных признаков для интеграции пространственных и временных карт признаков, причем объединенные карты признаков подвергаются увеличению разрешения до целевого размера высокого разрешения. 
Наконец, слой реконструкции используется для восстановления кадров высокого разрешения RGB-канала~\cite{Xiaobin2019}.

Конечная цель суперразрешения видео --- обучить производящую функцию $F$, которая оценивает кадры высокого разрешения по входным кадрам низкого разрешения. 
Пусть $I^{LR}_T$ --- входные кадры низкого разрешения, $I^{HR}$ --- исходные кадры высокого разрешения, тогда задача суперразрешения видео может быть описана следующим образом:
\begin{equation}
I^{HR}_T = F(\{I^{LR}_T,~I^{LR}_{T + i}\}),~i \in \{\pm 1,~...,~\pm k\},
\end{equation}
где $T$ --- текущая временная метка, $i$ --- последовательная $i$-я временная метка~\cite{Xiaobin2019}.

Остаточный обратимый блок. 
Кадры высокого разрешения должны иметь структуру, аналогичную входным кадрам низкого разрешения --- это важное свойство называется пространственной информацией. 
В текущем методе используется остаточный обратимый блок, в котором создается остаточное соединение, а параллельный обратимый блок предназначен для изучения разницы между кадрами низкого и высокого разрешения. 
На рисунке~\ref{img:ristn-rib} показана архитектура остаточного обратимого блока. 
Знак $\oplus$ означает поэлементное сложение~\cite{Xiaobin2019}.

\includeimage
    {ristn-rib}
    {f}
    {H}
    {1\textwidth}
    {Архитектура остаточного обратимого блока~\cite{Xiaobin2019}}
    
На рисунке показано, что входные признаки $F_{\text{fea}}$ делятся на два подслоя $X^{(0)}_{0}$ и $X^{(0)}_{1}$. 
Далее определяется сверточное бутылочное горлышко $F_i,~i~\in~[1,~2,~...,~n - 1]$. 
Сверточное бутылочное горлышко состоит из слоев свертки, пакетной нормализации и срезанных линейных узлов. 
Признаки $X^{(i - 1)}_{1}$ и $X^{(i - 1)}_{0}$ могут быть получены по формулам:
\begin{equation}
X^{(i - 1)}_{1} = X^{(i)}_{1} - F_{i}(X^{(i - 1)}_{0}),
\end{equation}
\begin{equation}
X^{(i - 1)}_{0} = X^{(i)}_{0}.
\end{equation}
Согласно приведенным выше формулам, предыдущие признаки могут быть последовательно выведены из любого $X^{(i)}_{1}$ и $X^{(i)}_{0}$. 
Таким образом, результат работы пространственного компонента можно записать в следующем виде:
\begin{equation}
X_{\text{out}} = [X^{(n)}_{0},~X^{(n)}_{1}] + X_{\text{fea}},
\end{equation}
где $,$ обозначает объединение карт признаков~\cite{Xiaobin2019}.

Рекуррентная модель с короткими соединениями. 
Во временном компоненте используется сверточная долгая краткосрочная память для определения информативных признаков последовательных кадров. 
В отличие от обычного одномерной долгой краткосрочной памяти, сверточная захватывает двумерные признаки из соседних временных меток. 
Для тщательного использования временной согласованности сверточная долгая краткосрочная память построена как двунаправленная архитектура, в которой выходные данные прямого и обратного хода объединяются и образуют выходные данные одного нейрона. 
На рисунке~\ref{img:ristn-lstm} показаны архитектуры различных модификаций сверточной долгой краткосрочной памяти~\cite{Xiaobin2019}.

\includeimage
    {ristn-lstm}
    {f}
    {H}
    {1\textwidth}
    {Архитектуры различных модификаций сверточной долгой краткосрочной памяти~\cite{Xiaobin2019}}
    
Результат работы временного компонента можно записать в следующем виде:
\begin{equation}
X_{out} = W_{1 \times 1 \times c \times c'} * X_{in} + [H_0,~H_1,~...,H_{n - 1}]_{c'},
\end{equation}
где $[H_0,~H_1,~...,H_{n - 1}]$ --- конкатенация карт признаков, полученных на всех предыдущих слоях, $X_{in}$ и $X_{out}$ --- входные и выходные данные временного компонента, $W$ --- матрица сверточного фильтра размера $1 \times 1$, $c$ --- исходное количество цветовых каналов, а $*$ обозначает операцию свертки, которая преобразует $c$ в $c'$~\cite{Xiaobin2019}.

Слияние разреженных признаков. 
Временные признаки будут преобразованы в то же пространство, что и пространственные признаки, с использованием слоя отображения. 
Предположим, что карты пространственных признаков $X_s$ имеют $c_1$ каналов, а карты временных признаков $X_t$ --- $c_2$ каналов. 
Пусть $c = 2 \times c_1$, тогда объединенные карты признаков $X_{concat}$ могут быть представлены в виде:
\begin{equation}
X_{concat} = [W_{1 \times 1 \times c_2 \times c_1} * X_t,~X_s]_{c},
\end{equation}
где $W$ --- сверточный фильтр временно-пространственного отображения, $c_2$ --- исходное количество каналов, $c_1$ --- выходное количество каналов, $*$ обозначает операцию свертки, а $,$ --- перекрестная конкатенация. 
Затем используется разреженная матрица $SM \in \mathbb{R}^{c \times c/2}$, предназначенная для выбора карт полезных признаков и адаптивного сжатия каналов признаков. 
Объединенные карты признаков $X_{\text{fused}}$ могут быть посчитаны по формуле:
\begin{equation}
X_{\text{fused}} = X_{\text{concat}} \times SM,
\end{equation}
где $\times$ означает матричное умножение~\cite{Xiaobin2019}. 

Увеличение разрешения во время реконструкции. 
В компоненте реконструкции создаются деконволюционные слои для увеличение разрешения карт признаков до целевого высокого разрешения. 
В данном методе используются слои обратной свертки в качестве слоя увеличения разрешения в компоненте реконструкции для того, чтобы преобразованные объекты подвергались увеличению разрешения в конце сети. 
В отличие от субпиксельной свертки, уровень деконволюции адаптивно допускает в качестве входных данных произвольные номера каналов, а не фиксированные числа. 
Для увеличения разрешения карт признаков используются два стека слоев деконволюции с небольшими ядрами размером $3 \times 3$ и 256-ю картами признаков~\cite{Xiaobin2019}.

\chapter{Классификация методов увеличения разрешения видеопотока}

\section{Критерии оценки методов увеличения разрешения видеопотока}

Для сравнения и оценки производительности методов суперразрешения используются такие показатели, как пиковое отношение сигнала к шуму и индекс структурного сходства. 
Среднеквадратическая ошибка, которая представляет собой среднюю ошибку между исходным и улучшенным изображением, используется для расчета пикового отношения сигнала к шуму. 
Формула для нахождения среднеквадратической ошибки~\cite{Daithankar2021}:
\begin{equation}
MSE = \frac{1}{mn} \sum_{i = 0}^{m - 1} \sum_{j = 0}^{n - 1} [X(i,~j) - \hat{X}(i,~j)].
\end{equation}
Формула для нахождения пикового отношения сигнала к шуму~\cite{Daithankar2021}:
\begin{equation}
PSNR = 20 \log_{10}(\frac{1}{\sqrt{MSE}}).
\end{equation}

Сходство между исходным изображением и изображением, полученным в результате использования метода суперразрешения, вычисляется по индексу структурного сходства. 
Параметрами, используемыми для расчета, являются яркость, контрастность и структурные изменения между двумя изображениями. 
Индекс структурного сходства определяется уравнением~\cite{Daithankar2021}:
\begin{equation}
SSIM(X,~\hat{X}) = \frac{(2 \mu_x \mu_{\hat{x}} + C_1)(2 \sigma_{x \hat{x}} + C_2)}{(\mu_x^2 + \mu_{\hat{x}}^2 + C_1)(\sigma_x^2 + \sigma_{\hat{x}}^2 + C_2)},
\end{equation}
где $\mu_x$ и $\mu_{\hat{x}}$ --- среднее $x$ и $\hat{x}$ соответственно, $\sigma_x^2$ и $\sigma_{\hat{x}}^2$ --- дисперсия $x$ и $\hat{x}$ соответственно, $\sigma_{x \hat{x}}$ --- ковариация $x$ и $\hat{x}$, а $C_1 = (k_1 L)^2$ и $C_2 = (k_2 L)^2$ --- две переменные (где $L$ --- динамический диапазон пикселей, а $k_1 = 0.01$ и $k_2 = 0.03$ --- константы).

\section{Сравнение методов увеличения разрешения видеопотока}

В таблице~\ref{tabular:comparison} приведены данные, по которым можно сравнить рассмотренные методы увеличения разрешения видеопотока. 
Четыре критерия: подход, пиковое отношение сигнала к шуму, индекс структурного сходства и максимальное значение коэффициента масштабирования max(r).

\begin{table}[H]
\caption{Сравнение методов увеличения разрешения видеопотока}
\label{tabular:comparison}
\begin{tabular}{|p{4cm}|p{4.25cm}|p{2cm}|p{2cm}|p{2cm}|}
\hline
\textbf{Метод} & \textbf{Подход} & \textbf{PSNR} & \textbf{SSIM} & \textbf{max(r)}
\tabularnewline
\hline
Бикубическая интерполяция & интерполяционный & $26.4037$ & $0.7227$ & 2
\tabularnewline
\hline
Нелокальная регуляризация и надежная оценка движения & регуляризационный & $33.18$ & --- & 2
\tabularnewline
\hline
Динамические фильтры увеличения разрешения без явной компенсации движения & нейронные сети & $31.65$ & $0.897$ & 4
\tabularnewline
\hline
Остаточная обратимая пространственно-временная нейронная сеть & нейронные сети & $28.90$ & $0.8898$ & 4
\tabularnewline
\hline
\end{tabular}
\end{table}

Исходя из полученных данных нельзя точно сказать, какой из рассмотренных методов увеличения разрешения видеопотока является наилучшим. 
Самый высокий показатель пикового отношения сигнала к шуму у метода нелокальной регуляризации и надежной оценки движения. 
Но недостаток данного метода --- максимальный коэффициент масштабирования, равный 2-м. 
У метода динамических фильтров увеличения разрешения без явной компенсации движения наилучший показатель индекса структурного сходства. 
Наихудшие показатели у бикубической интерполяции.

{\centering \chapter*{ЗАКЛЮЧЕНИЕ}}
\addcontentsline{toc}{chapter}{ЗАКЛЮЧЕНИЕ}

В ходе выполнения научно-исследовательской работы была достигнута поставленная цель, а также решены все задачи:
\begin{enumerate}
\item[1)] исследована предметная область увеличения разрешения видеопотока;
\item[2)] проанализированы известные методы увеличения разрешения видеопотока;
\item[3)] сформулированы критерии для сравнения этих методов;
\item[4)] проведено сравнение методов увеличения разрешения видеопотока по сформулированным критериям.
\end{enumerate}

В результате проведения сравнения по 4-м критериям было выявлено, что самый высокий показатель пикового отношения сигнала к шуму у метода нелокальной регуляризации и надежной оценки движения, в то время как у метода динамических фильтров увеличения разрешения без явной компенсации движения наилучший показатель индекса структурного сходства. 
Притом второй метод позволяет увеличивать разрешение видеопотока в 4 раза. 
Наихудшим из рассмотренных по всем показателям оказался метод бикубической интерполяции.

{\centering {\center\printbibliography[title=СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ]}}
\addcontentsline{toc}{chapter}{СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ}

{\centering \chapter*{ПРИЛОЖЕНИЕ А}}
\addcontentsline{toc}{chapter}{ПРИЛОЖЕНИЕ А Презентация}

\end{document}
